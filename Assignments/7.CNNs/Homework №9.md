# Homework №9

Добро пожаловать к одному из самых интересных (я начинал своё знакомство с ИИ именно с этих тем) разделу ИИ - свёрточные нейронные сети. Именно здесь началось мое знакомство с ИИ.

Опять-таки: в этом задании можно пользоваться всеми чат-ботами, **для ее приема нужно добиться** значений метрик Accuracy, Precision, Recall выше 0.95. Домашка принимается в формате .ipynb!

Итак, как вы уже могли услышать на лекции - впервые свёрточные нейронные сети появились за счет... Кошек. 

Ну да-да, все любят котиков. Кроме аллергиков, конечно. Ладно, речь сегодня отчасти о кошках и пойдет.

Итак, свёрточные нейронные сети - Convolutional Neural Networks. Вообще, обычно говорят именно о CV - то есть, Computer Vision, или компьютерное зрение, это общее направление изучения в плане ИИ (или алгоритмов) связанных с изображениями или видео (поток изображений).

Наш сегодняшний пациент - датасет [Dog VS Cat](https://www.kaggle.com/datasets/anthonytherrien/dog-vs-cat). Как вы понимаете - в нем есть кошечки и собачки, и нейронке нужно ответить достаточно просто: кошечка или собачка перед ней. 

Расчехляйте свои умы, товарищи, сейчас выбор двух путей: либо вы можете установить себе на компьютер Python (желательно бы иметь при этом видеокарту, так будет куда быстрее  и проще), либо скипнуть этот блок и всё сделать на **Colab** (там условно-бесплатные ресурсы). Выбор за вами!

Инструкцию я приводить не буду в силу того, насколько у систем всё отличается друг от друга - если вам хочется сделать это всё на своем железе, то время гуглить 

Если Вы используете [Google Colab](https://colab.google/), то как вы понимаете, там это всё поставлено :) 

Для начала скачиваем датасет с ссылки выше, жмите на многоточие и клацаем "Copy command API", либо просто скопируйте команду ниже и вставьте в любую ячейку на Colab :)

```bash
!kaggle datasets download -d anthonytherrien/dog-vs-cat
```

У вас скачался датасет, my congrat's! 

Теперь у вас появилась .zip папка - ее нужно распаковать, после чего - вуаля, у вас появился первый *датасет* для задачи компьютерного зрения. 

```bash
# Здесь происходит следующее - с кагла мы явно скачали .zip архив, его нужно было распаковать, после чего у нас вышла папка animal, содержщащая подпапки cat и dog
!unzip dogs-vs-cat.zip
```

Победа! Мы уже нейронщики?! Пока еще нет.

Теперь смотрите, мы с вами подобрались к следующему этапу: установке нужных библиотек. 

Сегодня мы устанавливаем Pytorch и всё связанное с ним

```bash
pip3 install torch torchvision torchmetrics scikit-learn
```

Вуаля, наше окружение подготовлено для работы.

Что теперь? А теперь чат-бот и Интернет :)

Дам вам список импортов - это то, что в вашем коде обязано использоваться, всё остальное вы сможете выбить с любого чат-бота. Если будут ошибки, связанные с формами тензоров, то он тоже сможет помочь.

```python
import torch

import torch.nn as nn

import torch.optim as optim

from torchvision import datasets, transforms, models

from torch.utils.data import DataLoader

from torchmetrics.classification import BinaryAccuracy, BinaryPrecision, BinaryRecall
```

**Также важно**: модель должна использоваться resnet34 ПРЕДОБУЧЕННАЯ, batch_size=16, метрики импортированы выше, оптимизатор SGD с learning_rate=6e-3, функция потерь - BCEWithLogitsLoss. Обязательно выводить значение лосса, Accuracy, Precision и Recall каждый проход цикла.

Для transform используется следующий объект:

```python
transform = transforms.Compose([

transforms.Resize(224),

transforms.CenterCrop(224),

transforms.ToTensor(),

transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])

])
```

***Задание на звёздочку***: необходимо построить графики значения функции потерь, Accuracy, Precision и Recall, а также их проанилизировать.

***Задание на ДВЕ звёздочки:*** довести значение этих метрик до 0.95 из **НЕПРЕДОБУЧЕННОЙ** модели.